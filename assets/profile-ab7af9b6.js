import{a as R,u as U,e as T,l as q,i as z,f as $,r as o,o as u,c as d,w as t,b as e,g as l,t as s,h as w,j as r,k as p,F,m as B,d as j,_ as A}from"./index-30087d62.js";const G=r("td",null,null,-1),H={__name:"profile",setup(J){const N=R(),S=U(),a=T(null),m=T(!0),v=q(`${z}/profile`,{auth:{token:localStorage.getItem("token")},transports:["websocket"]});v.on("connect",async()=>{const n=await $.get("/game/get_game_status");n.data.status==="pending"||n.data.status==="settling"?m.value=!0:n.data.status==="running"?(await V(),S.year=n.data.current_year,m.value=!1):n.data.status==="finished"&&await N.push("/result")}),v.on("disconnect",()=>{console.log("socket disconnected"),setTimeout(()=>{v.connect()},5e3)}),v.on("game_status",async n=>{n.status==="pending"||n.status==="settling"?m.value=!0:n.status==="running"?(await V(),m.value=!1):n.status==="finished"&&await N.push("/result")});async function V(){const n=await $.post("/game/profile");a.value=n.data.data,S.profile=n.data.data.current_year}return(n,K)=>{const y=o("v-card-title"),g=o("v-divider"),_=o("v-icon"),c=o("v-list-item-title"),i=o("v-list-item-subtitle"),f=o("v-list-item"),C=o("v-list"),k=o("v-card"),D=o("v-table"),E=o("v-card-text"),h=o("v-container"),I=A;return a.value&&!m.value?(u(),d(h,{key:0,fluid:"",class:"fill-height align-content-start"},{default:t(()=>[e(h,null,{default:t(()=>[e(k,null,{default:t(()=>[e(y,null,{default:t(()=>[l(" 账户信息 ")]),_:1}),e(g),e(C,null,{default:t(()=>[e(f,null,{prepend:t(()=>[e(_,{color:"primary"},{default:t(()=>[l("mdi-cash")]),_:1})]),default:t(()=>[e(c,null,{default:t(()=>[l("现金")]),_:1}),e(i,null,{default:t(()=>[l(s(a.value.money.toFixed(2)),1)]),_:1})]),_:1}),e(f,null,{prepend:t(()=>[e(_,{color:"primary"},{default:t(()=>[l("mdi-bank")]),_:1})]),default:t(()=>[e(c,null,{default:t(()=>[l("银行存款")]),_:1}),e(i,null,{default:t(()=>[l(s(a.value.bank.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{class:"mt-3"},{default:t(()=>[e(y,null,{default:t(()=>[l("借款")]),_:1}),e(g),e(C,null,{default:t(()=>[e(f,null,{prepend:t(()=>[e(_,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(c,null,{default:t(()=>[l("您今年的借款额度")]),_:1}),e(i,null,{default:t(()=>[l(s(a.value.max_loan.toFixed(2)),1)]),_:1})]),_:1}),a.value.loan?(u(),d(f,{key:0},{prepend:t(()=>[e(_,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(c,null,{default:t(()=>[l("您当前借款")]),_:1}),e(i,null,{default:t(()=>[l(s(a.value.loan.loan.toFixed(2)),1)]),_:1})]),_:1})):w("",!0),a.value.loan?(u(),d(f,{key:1},{prepend:t(()=>[e(_,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(c,null,{default:t(()=>[l("借款周期")]),_:1}),e(i,null,{default:t(()=>[l(s(a.value.loan.loan_period),1)]),_:1})]),_:1})):w("",!0),a.value.loan?(u(),d(f,{key:2},{prepend:t(()=>[e(_,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(c,null,{default:t(()=>[l("需付利息")]),_:1}),e(i,null,{default:t(()=>[l(s(a.value.loan.interest.toFixed(2)),1)]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1}),e(k,{class:"mt-3"},{default:t(()=>[e(y,null,{default:t(()=>[l("当年持仓")]),_:1}),e(g),e(D,null,{default:t(()=>[r("tbody",null,[(u(!0),p(F,null,B(a.value.current_year_stock,(x,b)=>(u(),p("tr",null,[r("td",null,s(b),1),r("td",null,s(x),1)]))),256))])]),_:1})]),_:1}),e(k,{class:"mt-3"},{default:t(()=>[e(y,null,{default:t(()=>[l("历史记录")]),_:1}),e(g),a.value.history.length>0?(u(),d(D,{key:0},{default:t(()=>[(u(!0),p(F,null,B(a.value.history,(x,b)=>(u(),p("tbody",null,[r("tr",null,[r("td",null,s(b),1),G]),(u(!0),p(F,null,B(x,(L,P)=>(u(),p("tr",null,[r("td",null,s(P),1),r("td",null,s(L),1)]))),256))]))),256))]),_:1})):(u(),d(E,{key:1},{default:t(()=>[l(" 暂无数据 ")]),_:1}))]),_:1})]),_:1})]),_:1})):(u(),d(h,{key:1},{default:t(()=>[e(I)]),_:1}))}}};typeof j=="function"&&j(H);export{H as default};
