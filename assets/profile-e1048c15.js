import{a as U,u as z,r as F,n as A,p as G,b as q,c as r,d as u,e as _,w as t,f as e,j as l,t as s,i as S,k as a,h as v,F as $,l as B,q as H,v as J,m as E,_ as K}from"./index-6728f951.js";const M=a("tr",null,[a("th",{style:{"font-weight":"bold"}},"股票名称"),a("th",{style:{"font-weight":"bold"}},"持有数量"),a("th",{style:{"font-weight":"bold"}},"持有市值")],-1),O=a("th",null,null,-1),Q=a("tr",null,[a("th",null,"股票名"),a("th",null,"数量"),a("th",null,"开盘价"),a("th",null,"收盘价")],-1),W={__name:"profile",setup(X){const D=U(),N=z(),n=F(null);F(null);const m=F(!0),h=A(`${G}/profile`,{auth:{token:localStorage.getItem("token")},transports:["websocket"]});h.on("connect",async()=>{const o=await q.get("/game/get_game_status");o.data.status==="pending"||o.data.status==="settling"?m.value=!0:o.data.status==="running"?(await V(),N.year=o.data.current_year,m.value=!1):o.data.status==="finished"&&await D.push("/result")}),h.on("disconnect",()=>{console.log("socket disconnected"),setTimeout(()=>{h.connect()},5e3)}),h.on("game_status",async o=>{o.status==="pending"||o.status==="settling"?m.value=!0:o.status==="running"?(await V(),m.value=!1):o.status==="finished"&&await D.push("/result")});async function V(){const o=await q.post("/game/profile");n.value=o.data.data,N.profile=o.data.data.current_year}return(o,Y)=>{const g=r("v-card-title"),k=r("v-divider"),c=r("v-icon"),d=r("v-list-item-title"),i=r("v-list-item-subtitle"),f=r("v-list-item"),C=r("v-list"),b=r("v-card"),I=r("v-alert"),T=r("v-card-text"),L=r("v-chip"),j=r("v-table"),w=r("v-container"),P=K;return n.value&&!m.value?(u(),_(w,{key:0,fluid:"",class:"fill-height align-content-start"},{default:t(()=>[e(w,null,{default:t(()=>[e(b,null,{default:t(()=>[e(g,null,{default:t(()=>[l(" 账户信息 ")]),_:1}),e(k),e(C,null,{default:t(()=>[e(f,null,{prepend:t(()=>[e(c,{color:"primary"},{default:t(()=>[l("mdi-cash")]),_:1})]),default:t(()=>[e(d,null,{default:t(()=>[l("现金")]),_:1}),e(i,null,{default:t(()=>[l(s(n.value.money.toFixed(2)),1)]),_:1})]),_:1}),e(f,null,{prepend:t(()=>[e(c,{color:"primary"},{default:t(()=>[l("mdi-bank")]),_:1})]),default:t(()=>[e(d,null,{default:t(()=>[l("银行存款")]),_:1}),e(i,null,{default:t(()=>[l(s(n.value.bank.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(b,{class:"mt-3"},{default:t(()=>[e(g,null,{default:t(()=>[l("借款")]),_:1}),e(k),n.value.loan?(u(),_(T,{key:0},{default:t(()=>[e(I,{density:"compact",text:"您必须还清之前的借款才能再次借款",icon:"mdi-scale-balance",type:"warning"})]),_:1})):S("",!0),e(C,null,{default:t(()=>[n.value.loan?(u(),_(f,{key:1},{prepend:t(()=>[e(c,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(d,null,{default:t(()=>[l("您当前借款")]),_:1}),e(i,null,{default:t(()=>[l(s(n.value.loan.loan.toFixed(2)),1)]),_:1})]),_:1})):(u(),_(f,{key:0},{prepend:t(()=>[e(c,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(d,null,{default:t(()=>[l("您今年的借款额度 "),e(L,null,{default:t(()=>[l("当年开盘时所持总资产的20%")]),_:1})]),_:1}),e(i,null,{default:t(()=>[l(s(n.value.max_loan.toFixed(2)),1)]),_:1})]),_:1})),n.value.loan?(u(),_(f,{key:2},{prepend:t(()=>[e(c,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(d,null,{default:t(()=>[l("借款周期")]),_:1}),e(i,null,{default:t(()=>[l(s(n.value.loan.loan_period),1)]),_:1})]),_:1})):S("",!0),n.value.loan?(u(),_(f,{key:3},{prepend:t(()=>[e(c,{color:"primary"},{default:t(()=>[l("mdi-currency-usd")]),_:1})]),default:t(()=>[e(d,null,{default:t(()=>[l("需要偿还 (本金+利息)")]),_:1}),e(i,null,{default:t(()=>[l(s(n.value.loan.total_amount.toFixed(2)),1)]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),e(b,{class:"mt-3"},{default:t(()=>[e(g,null,{default:t(()=>[l("当年持仓")]),_:1}),e(k),e(j,null,{default:t(()=>[a("tbody",null,[M,(u(!0),v($,null,B(n.value.current_year_stock,(y,p)=>H((u(),v("tr",null,[a("td",null,s(p),1),a("td",null,s(y)+" 股",1),a("td",null,"$"+s((y*n.value.current_year_stock_data[p]).toFixed(2)),1)],512)),[[J,y>0]])),256))])]),_:1})]),_:1}),e(b,{class:"mt-3"},{default:t(()=>[e(g,null,{default:t(()=>[l("历史记录")]),_:1}),e(k),n.value.history?(u(),_(j,{key:0},{default:t(()=>[(u(!0),v($,null,B(n.value.history,(y,p)=>(u(),v("tbody",null,[a("tr",null,[a("th",null,s(p),1),O]),Q,(u(!0),v($,null,B(y,(R,x)=>(u(),v("tr",null,[a("td",null,s(x),1),a("td",null,s(R)+" 股",1),a("td",null,"$"+s(n.value.previous_year_stock_data[x][p].open),1),a("td",null,"$"+s(n.value.previous_year_stock_data[x][p].close),1)]))),256))]))),256))]),_:1})):(u(),_(T,{key:1},{default:t(()=>[l(" 暂无数据 ")]),_:1}))]),_:1})]),_:1})]),_:1})):(u(),_(w,{key:1},{default:t(()=>[e(P)]),_:1}))}}};typeof E=="function"&&E(W);export{W as default};
